<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title id="pageTitle">Producto - DescoApp</title>

  <!-- Metadatos dinámicos -->
  <meta property="og:title" content="" id="metaTitle">
  <meta property="og:description" content="" id="metaDescription">
  <meta property="og:image" content="" id="metaImage">
  <meta property="og:url" content="" id="metaUrl">
  <meta property="og:type" content="product">

  <link rel="icon" href="img/logo.png" type="image/png">
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <header class="logo-header">
    <img src="img/logo.png" class="logo" alt="DescoApp Logo">
  </header>

  <main id="detalleProducto" class="producto-detalle">
    <p>Cargando producto...</p>
  </main>

  <footer class="footer">
    <p>&copy; 2025 DescoApp Marketplace. Todos los derechos reservados.</p>
  </footer>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const id = urlParams.get('id');

    // Cargar producto desde tu JSON real
    async function cargarProducto() {
      const res = await fetch('data/productos_proveedores.json');
      const productos = await res.json();

      const producto = productos.find(p => p.id == id);

      if (!producto) {
        document.getElementById("detalleProducto").innerHTML = "<h2>Producto no encontrado</h2>";
        return;
      }

      // Construir mensaje con link para volver a comprar
      const urlProducto = `${window.location.origin}/producto.html?id=${producto.id}`;
      const mensajeWhatsApp = encodeURIComponent(
        `Hola, quiero comprar este producto:\n${producto.nombre}\nPrecio: ${producto.precio}\n\nVolver a comprar: ${urlProducto}`
      );

      // WhatsApp del proveedor si existe; si no, usa uno central
      const numeroWhatsApp = "573143416441";

      // Renderizar detalle del producto
      document.title = `${producto.nombre} - DescoApp`;

      document.getElementById("detalleProducto").innerHTML = `
        <img src="${producto.imagen}" alt="${producto.nombre}" class="producto-img">
        <h1>${producto.nombre}</h1>
        <p class="precio">${producto.precio}</p>
        <p>${producto.descripcion}</p>

        <a href="https://wa.me/${numeroWhatsApp}?text=${mensajeWhatsApp}"
           target="_blank" class="btn-wsp">
          Comprar por WhatsApp
        </a>

        <a href="index.html" class="btn-volver">
          Volver al catálogo
        </a>
      `;

      // Actualizar metadatos OG para compartir profesionalmente
      document.getElementById("metaTitle").setAttribute("content", producto.nombre);
      document.getElementById("metaDescription").setAttribute("content", producto.descripcion);
      document.getElementById("metaImage").setAttribute("content", window.location.origin + producto.imagen);
      document.getElementById("metaUrl").setAttribute("content", urlProducto);
    }

    cargarProducto();
  </script>

</body>
</html>
